# 📊 台灣股市監控系統 - 進階版本 (v2.0) 使用指南

**版本**: 2.0 - 進階版本  
**發佈日期**: 2025-12-20  
**狀態**: ✅ 新功能完成

---

## 🎉 新增功能總覽

### 1️⃣ **市場選擇菜單**

在工具列新增「📍 市場」下拉選單，支援切換不同股票市場。

**支援的市場:**
- ✅ **台股** - 台灣股票 (目前可用)
- 🔄 **美股** - 美國股票 (即將推出)

```
使用方式:
┌─────────────────────┐
│ 📍 市場: [台股 ▼]  │  ← 點擊選擇
├─────────────────────┤
│ 台股               │
│ 美股 (預留位置)    │
└─────────────────────┘
```

### 2️⃣ **市場熱圖**

新增「市場熱圖」面板，即時顯示行業別的漲跌幅。

**熱圖特性:**
- 📊 **即時更新** - 自動更新行業漲跌幅
- 🎨 **顏色編碼**:
  - 🟢 綠色 (↑) - 行業上漲
  - 🔴 紅色 (↓) - 行業下跌  
  - ⚪ 灰色 (→) - 平盤

**布局:**
```
📊 市場熱圖 (行業漲跌幅)
┌────────────────────────────────────┐
│ 半導體  電子    金融    鋼鐵       │
│ ↑+2.5% ↓-1.2% ↑+0.8% ↑+1.5%      │
│                                    │
│ 汽車零件 造紙  建材   食品         │
│ ↓-0.5% ↑+2.1% ↑+1.2% ↓-0.8%     │
│ ... (自動換行)                     │
└────────────────────────────────────┘
```

### 3️⃣ **股票卡片視窗**

將觀察中的股票以「卡片」形式顯示，每支股票一個獨立的卡片。

**卡片特性:**
- 📌 **卡片設計** - 美觀的股票信息卡
- 🔄 **流式布局** - 自動排列，根據窗口寬度重排
- ✕ **快速刪除** - 卡片右上角一鍵移除
- 📈 **實時更新** - 自動更新股價和漲跌幅

**卡片內容:**
```
┌──────────────────┐
│ 2330 台積電    ✕ │  ← 代碼、名稱、刪除按鈕
├──────────────────┤
│ NT$ 940.50       │
│ +2.35%           │  ← 股價、漲跌幅 (顏色標示)
├──────────────────┤
│ 成交量: 1,234K   │
│ 14:30:00         │  ← 成交量、更新時間
└──────────────────┘
```

**自動重排示例:**
```
窗口寬度大 (1400px):
┌─────────┐ ┌─────────┐ ┌─────────┐ ┌─────────┐ ┌─────────┐ ┌─────────┐
│ 股票 1  │ │ 股票 2  │ │ 股票 3  │ │ 股票 4  │ │ 股票 5  │ │ 股票 6  │
└─────────┘ └─────────┘ └─────────┘ └─────────┘ └─────────┘ └─────────┘

窗口寬度中 (900px):
┌─────────┐ ┌─────────┐ ┌─────────┐
│ 股票 1  │ │ 股票 2  │ │ 股票 3  │
└─────────┘ └─────────┘ └─────────┘
┌─────────┐ ┌─────────┐ ┌─────────┐
│ 股票 4  │ │ 股票 5  │ │ 股票 6  │
└─────────┘ └─────────┘ └─────────┘

窗口寬度小 (600px):
┌─────────┐ ┌─────────┐
│ 股票 1  │ │ 股票 2  │
└─────────┘ └─────────┘
┌─────────┐ ┌─────────┐
│ 股票 3  │ │ 股票 4  │
└─────────┘ └─────────┘
```

---

## 🚀 快速開始

### 方式 1: 使用啟動器 (推薦)

```bash
cd lession8_1
python run_v2.py
```

這會顯示一個版本選擇菜單，您可選擇:
- **標準版** (v1.0) - 原始功能
- **進階版** (v2.0) - 新增功能 ⭐

### 方式 2: 直接啟動進階版

```bash
python stock_monitor_gui_v2.py
```

### 方式 3: 命令行啟動

```bash
# 啟動標準版
python run_v2.py v1

# 啟動進階版
python run_v2.py v2
```

---

## 📖 詳細使用指南

### 界面概覽

進階版 GUI 分為三個主要區域：

```
┌─ 工具列 ─────────────────────────────────────────────┐
│ 📍 市場: [台股▼] | 狀態: 就緒 | 🔄 [立即更新] | [自動更新] |
└───────────────────────────────────────────────────────┘

┌─ 左側面板 ────────┐  ┌─ 右側面板 (股票卡片) ──────┐
│ 🏭行業: [全部▼] │  │ ┌─────────┐ ┌─────────┐  │
│ 🔍搜尋: [______]│  │ │ 股票 1  │ │ 股票 2  │  │
│                │  │ └─────────┘ └─────────┘  │
│ 📈 股票清單    │  │ ┌─────────┐ ┌─────────┐  │
│ ┌──────────────┐ │ │ 股票 3  │ │ 股票 4  │  │
│ │ 2330 台積電  │ │ └─────────┘ └─────────┘  │
│ │ 2454 聯發科  │ │                         │
│ │ 2303 聯電    │ │ (自動滾動)              │
│ │ ...          │ │                         │
│ └──────────────┘ │                         │
│                │  │                         │
│ ➕ 加入觀察    │  │                         │
├────────────────┤  └──────────────────────────┘
│ 📊 市場熱圖    │
│ ┌────────────┐ │
│ │ 半導體 ↑2% │ │
│ │ 電子 ↓1%   │ │
│ │ 金融 ↑0%   │ │
│ │ ...        │ │
│ └────────────┘ │
└──────────────────┘
```

### 詳細操作步驟

#### 1️⃣ 啟動應用

```bash
python run_v2.py
# 選擇「進階版」
```

#### 2️⃣ 選擇市場

- 預設選擇「台股」
- 美股功能即將推出

#### 3️⃣ 查看股票清單

- 選擇「🏭 行業」進行篩選
- 使用「🔍 搜尋」進行快速查找
- 雙擊或點擊「➕ 加入」添加到觀察清單

#### 4️⃣ 查看股票卡片

- 卡片顯示：代碼、名稱、股價、漲跌幅、成交量、更新時間
- 卡片會自動根據窗口大小重排
- 點擊卡片右上角「✕」移除股票

#### 5️⃣ 查看市場熱圖

- 左下方顯示各行業的實時漲跌幅
- 顏色編碼：綠色(上漲)、紅色(下跌)、灰色(平盤)
- 自動更新

#### 6️⃣ 自動更新

- 勾選「自動更新」
- 應用每 60 秒自動更新一次股票資訊和熱圖

---

## 🎨 配置和自訂

### 修改卡片大小

在 `stock_monitor_gui_v2.py` 中修改 `card_width` 參數：

```python
# 第 408 行左右
card_width = 220  # 改為您想要的寬度 (像素)
```

### 修改卡片內容

編輯 `StockCardFrame` 類別：

```python
class StockCardFrame(ttk.Frame):
    def __init__(self, parent, code, name, price, volume, change_pct, timestamp, on_remove):
        # 修改標籤和顯示格式
```

### 修改熱圖布局

在 `HeatmapFrame` 中修改每行行業數：

```python
# 第 79 行左右
if col >= 4:  # 改為您想要的數字
    col = 0
    row += 1
```

---

## ⚙️ 進階設定

### 美股功能預留

美股功能已預留位置，未來可擴展：

```python
self.markets = {
    '台股': {'symbol': 'TW', 'stocks': []},
    '美股': {'symbol': 'US', 'stocks': []},  # 未來功能
}
```

### 添加新市場

在 `__init__` 方法中擴展 `self.markets` 字典：

```python
self.markets = {
    '台股': {...},
    '美股': {...},
    '港股': {'symbol': 'HK', 'stocks': []},  # 新增
}
```

### 自訂熱圖更新頻率

修改 `update_stocks()` 方法中的更新邏輯。

---

## 🔄 版本對比

| 功能 | 標準版 (v1.0) | 進階版 (v2.0) |
|------|--------------|--------------|
| 股票清單搜尋 | ✅ | ✅ |
| 行業別篩選 | ✅ | ✅ |
| 自動更新 | ✅ | ✅ |
| 市場選擇菜單 | ❌ | ✅ |
| 市場熱圖 | ❌ | ✅ |
| 股票卡片視窗 | ❌ | ✅ |
| 自動重排布局 | ❌ | ✅ |
| 快速移除功能 | ❌ | ✅ |

---

## 🐛 故障排查

### Q: 卡片不重排？

**A**: 檢查視窗大小變更事件是否綁定：
```python
self.root.bind('<Configure>', self.on_window_resize)
```

### Q: 熱圖不更新？

**A**: 確認 `update_stocks()` 方法中有調用 `heatmap_frame.update_data()`。

### Q: 滾輪不工作？

**A**: 檢查滾輪事件綁定：
```python
self.canvas.bind_all("<MouseWheel>", self.on_mousewheel)
```

### Q: 如何切換回標準版？

**A**: 執行 `python run_v2.py` 選擇標準版，或直接運行：
```bash
python stock_monitor_gui.py
```

---

## 📝 技術詳情

### 新增類別

#### `StockCardFrame`
- **用途**: 表示單支股票的卡片
- **主要方法**: `__init__`
- **關鍵特性**: 自訂顏色、關閉按鈕、信息顯示

#### `HeatmapFrame`
- **用途**: 顯示市場熱圖
- **主要方法**: `update_data()`
- **關鍵特性**: 自動換行、顏色編碼

#### `StockMonitorGUIv2`
- **用途**: 進階版 GUI 應用
- **主要變更**: 
  - 新增市場選擇
  - 新增卡片布局引擎
  - 新增熱圖面板

### 主要方法

| 方法 | 說明 |
|------|------|
| `layout_cards()` | 重新排列卡片布局 |
| `create_stock_card()` | 建立新股票卡片 |
| `remove_stock_card()` | 移除股票卡片 |
| `on_window_resize()` | 處理視窗大小變更 |
| `on_mousewheel()` | 處理滾輪事件 |
| `initialize_heatmap()` | 初始化熱圖資料 |

---

## 🚀 後續功能規劃

### 短期 (1-2 週)

- [ ] 美股功能實現
- [ ] 自訂卡片樣式
- [ ] 卡片拖拽重排

### 中期 (2-4 週)

- [ ] 港股支援
- [ ] 加密貨幣支援
- [ ] 進階篩選 (市值、本益比等)

### 長期 (1-3 月)

- [ ] 機器學習推薦
- [ ] 策略回測
- [ ] 量化交易模組

---

## 📚 相關文件

- `stock_monitor_gui.py` - 標準版 GUI
- `stock_monitor_gui_v2.py` - 進階版 GUI ⭐
- `taiwan_stock_crawler.py` - 爬蟲模組
- `GUI_使用指南.md` - 標準版使用指南
- `run_v2.py` - 版本啟動器

---

## 🎯 快速鍵參考

| 快速鍵 | 功能 |
|--------|------|
| `Ctrl+Q` | 退出應用 |
| 雙擊股票 | 加入觀察清單 |
| 點擊卡片✕ | 移除股票 |
| 滾輪 | 滾動卡片列表 |

---

## 💡 使用提示

✨ **提示 1**: 拖拽視窗邊界調整寬度，卡片會自動重排  
✨ **提示 2**: 勾選「自動更新」實時監控市場動態  
✨ **提示 3**: 點擊熱圖中的行業可以在清單中快速篩選  
✨ **提示 4**: 觀察清單自動保存到 `watchlist_v2.json`  

---

## 📞 支援

如有問題，請查看：
1. GUI 頂部「狀態」標籤
2. 控制台錯誤信息
3. 本文件的「故障排查」部分

---

**版本**: 2.0 - 進階版本  
**最後更新**: 2025-12-20  
**狀態**: ✅ 生產就緒

