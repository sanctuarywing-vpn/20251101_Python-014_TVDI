# 台灣股市即時監控 GUI 應用 - 使用指南

## 📌 簡介

這是一個基於 Python Tkinter 的**台灣股市即時監控應用**，提供以下功能：

✅ **按行業別分類** - 14+ 行業分類，每個行業精選市值前30大股票  
✅ **股票清單搜尋** - 快速搜尋特定行業或全部股票  
✅ **觀察清單管理** - 自行選擇需要監控的股票  
✅ **即時更新** - 自動每分鐘更新一次股票資訊  
✅ **數據顯示** - 股票代碼、名稱、股價、成交量、更新時間  
✅ **偏好設定保存** - 自動儲存觀察清單設定  

---

## 🚀 快速開始

### 安裝依賴

```bash
# 基本依賴（Python 3.7+）
pip install twstock  # 選項：如果要使用即時台股資料

# 或直接運行（已內建演示資料）
python stock_monitor_gui.py
```

### 執行應用

```bash
cd lession8_1
python stock_monitor_gui.py
```

---

## 📖 使用流程

### 1️⃣ 啟動應用

```
運行 stock_monitor_gui.py
↓
應用載入股票清單（14+ 行業，每行業 10+ 支股票）
↓
顯示「就緒」狀態
```

### 2️⃣ 篩選行業別

**在左側「股票清單」面板：**

```
1. 在「行業別」下拉選單選擇行業
   - 「全部」：顯示所有行業的股票
   - 「半導體」：台積電、聯發科、聯電等
   - 「電子」：鴻海、廣達等
   - 「金融」：中信金等
   - 「鋼鐵」、「汽車零件」、「造紙」等...

2. 選定行業後自動篩選左側股票清單
```

### 3️⃣ 搜尋股票

**在左側「股票清單」面板：**

```
1. 在搜尋框輸入關鍵字
   - 輸入代碼: "2330" → 顯示台積電
   - 輸入名稱: "聯" → 顯示所有含「聯」的股票

2. 搜尋結果根據選定行業篩選
   - 若選「半導體」+搜尋「聯」：顯示聯發科、聯電、聯詠等
   - 若選「全部」+搜尋「聯」：顯示所有行業含「聯」的股票
```

### 4️⃣ 加入觀察清單

**方式 A：雙擊股票**
```
1. 在左側「股票清單」中雙擊任意股票
2. 該股票自動加入右側「觀察中的股票」清單
```

**方式 B：點擊按鈕**
```
1. 在左側「股票清單」中選中股票
2. 點擊「➕ 加入觀察清單」按鈕
3. 確認加入
```

### 5️⃣ 查看即時資訊

**右側「觀察中的股票」面板顯示：**

| 欄位 | 說明 | 例子 |
|------|------|------|
| 代碼 | 股票代碼 | 2330 |
| 名稱 | 股票名稱 | 台積電 |
| 股價 | 即時股價（NT$） | $940.50 |
| 成交量 | 成交量（張） | 1,234,567 |
| 更新時間 | 最後更新時間 | 14:30:00 |

### 6️⃣ 自動更新

**啟用自動更新：**

```
1. 勾選工具列的「自動更新 (每分鐘)」
2. 應用每 60 秒自動更新一次觀察清單
3. 更新完成後顯示「最後更新: 時間」
```

**手動更新：**

```
1. 點擊「🔄 立即更新」按鈕
2. 應用立即更新所有觀察中的股票資訊
```

### 7️⃣ 移除股票

**方式 A：按鈕**
```
1. 在右側「觀察中的股票」中選中股票
2. 點擊「❌ 移除選中股票」
3. 該股票從清單移除
```

**方式 B：右鍵菜單**
```
1. 在右側「觀察中的股票」中右鍵點擊股票
2. 點擊「移除」
3. 該股票從清單移除
```

---

## 🎯 功能詳解

### 🏭 行業別篩選（新功能）

支援 14+ 行業分類，每個行業精選市值前 30 大股票：

| 行業代碼 | 行業名稱 | 代表股票 | 數量 |
|----------|----------|---------|------|
| 全部 | 所有行業 | 台積電、鴻海、台積電... | 100+ |
| 半導體 | 半導體 | 台積電(2330)、聯發科(2454)、聯電(2303) | 15+ |
| 電子 | 電子零組件 | 鴻海(2317)、廣達(2382) | 15+ |
| 金融 | 金融保險 | 中信金(2891) | 10+ |
| 鋼鐵 | 鋼鐵工業 | 中鋼(2002) | 10+ |
| 汽車零件 | 汽車零件 | 和泰車(2207) | 10+ |
| 造紙 | 紙漿紙業 | 永豐餘(1907) | 10+ |
| 建材 | 建材營造 | - | 10+ |
| 食品 | 食品飲料 | - | 10+ |
| 化學 | 化學工業 | - | 10+ |
| 電機 | 電機機械 | - | 10+ |
| 紡織 | 紡織纖維 | - | 10+ |
| 醫療 | 醫療保健 | - | 10+ |

**使用方式：**
```
1. 開啟應用
2. 在「行業別」下拉選單選擇興趣的行業
3. 左側自動篩選顯示該行業的股票
4. 或選「全部」查看所有股票
5. 使用搜尋框進一步精細化搜尋
```

### 📊 工具列功能

| 功能 | 按鈕/選項 | 說明 |
|------|---------|------|
| 狀態顯示 | 狀態文字 | 應用目前狀態 (就緒/載入中/錯誤) |
| 手動更新 | 🔄 立即更新 | 立即更新所有觀察中的股票 |
| 自動更新 | ☑ 自動更新 | 每 60 秒自動更新一次 |
| 最後更新 | 時間顯示 | 顯示最後一次更新的時間 |

### 📈 股票清單（左側）

- **行業篩選** - 快速切換不同行業（新增）
- **搜尋功能** - 實時搜尋股票代碼或名稱
- **雙擊加入** - 快速加入觀察清單
- **按鈕加入** - 選中後點擊按鈕加入
- **完整清單** - 顯示 100+ 支精選台股

### 👁️ 觀察清單（右側）

- **即時更新** - 顯示最新股價和成交量
- **時間戳** - 顯示數據更新時間
- **右鍵菜單** - 快速移除股票
- **自動保存** - 清單設定自動保存到本機

---

## 🔧 進階功能

### 自動保存觀察清單

觀察清單自動保存到 `watchlist.json` 檔案：

```json
["2330", "2454", "1101"]
```

重新啟動應用時會自動載入上次的設定。

### 擴展行業別分類

編輯 `taiwan_stock_crawler.py` 中的 `TAIWAN_STOCKS_BY_INDUSTRY` 字典添加或修改行業：

```python
TAIWAN_STOCKS_BY_INDUSTRY = {
    '半導體': [
        ('2330', '台積電'),
        ('2454', '聯發科'),
        # 添加更多...
    ],
    '新行業': [
        ('代碼', '名稱'),
        # 添加新行業及其股票...
    ]
}
```

### 修改更新間隔

編輯 `stock_monitor_gui.py` 中的 `schedule_auto_update()` 方法：

```python
# 將 60000 改為其他毫秒值
# 例如 30000 = 30 秒, 120000 = 2 分鐘
self.update_timer = self.root.after(60000, self.schedule_auto_update)
```

---

## 📊 示例操作流程

### 場景 1：監控半導體行業的股票

**步驟 1：選擇行業別**
```
在「行業別」下拉選單選擇: "半導體"
↓
左側列表顯示: 台積電、聯發科、聯電等半導體股票
```

**步驟 2：加入觀察**
```
搜尋框輸入: "台" （搜尋範圍受行業限制）
↓
顯示結果: 台積電
↓
雙擊 "台積電"
↓
右側顯示: 2330 | 台積電 | $940.50 | 1,234,567 | 14:30:00
```

**步驟 3：添加更多半導體股票**
```
搜尋框輸入: "聯"
↓
顯示結果: 聯發科、聯電、聯詠
↓
雙擊 "聯發科"
↓
右側顯示:
  2330 | 台積電    | $940.50 | 1,234,567 | 14:30:00
  2454 | 聯發科    | $1100.20| 2,345,678 | 14:30:01
```

### 場景 2：比較多個行業的龍頭股

**步驟 1：選擇半導體行業**
```
行業別 → 半導體
↓
搜尋框輸入: ""（不搜尋，顯示前 5 支）
↓
雙擊 "台積電" → 加入觀察
```

**步驟 2：切換到電子行業**
```
行業別 → 電子
↓
搜尋框自動清空（搜尋框保留但限制在新行業範圍）
↓
雙擊 "鴻海" → 加入觀察
```

**步驟 3：查看混合觀察清單**
```
右側顯示:
  2330 | 台積電 (半導體) | $940.50  | ... | 14:30:00
  2317 | 鴻海 (電子)     | $185.20  | ... | 14:30:01
```

**步驟 4：啟用自動更新**
```
勾選「自動更新 (每分鐘)」
↓
應用每 60 秒自動更新所有股票
↓
最後更新: 2025-12-20 15:30:00
```

### 場景 3：全市場搜尋

**步驟 1：搜尋特定股票**
```
行業別 → 全部
↓
搜尋框輸入: "2330"
↓
顯示: 2330 | 台積電
↓
雙擊加入觀察
```

**步驟 2：搜尋含特定字的所有股票**
```
行業別 → 全部
↓
搜尋框輸入: "聯"
↓
顯示所有含「聯」的股票（跨所有行業）
  聯發科 (半導體)
  聯電 (半導體)
  聯詠 (半導體)
  聯華 (食品)
  ...
```

---

## 🐛 常見問題

### Q1: 為什麼股價是模擬值？

**A**: 因為 twstock 模組未安裝。程式內建演示模式會生成隨機價格。  
若要使用實時台股資料，請安裝 twstock：
```bash
pip install twstock
```

### Q2: 觀察清單在哪裡保存？

**A**: 保存在應用同目錄的 `watchlist.json` 檔案中。  
刪除此檔案可重置清單。

### Q3: 如何修改更新時間？

**A**: 編輯 `stock_monitor_gui.py` 的 `schedule_auto_update()` 方法：
```python
self.update_timer = self.root.after(120000, self.schedule_auto_update)  # 改為 120 秒
```

### Q4: 支援多少支股票？

**A**: 演示模式內建 100+ 支（14+ 行業，每行業 10+ 支）；使用 twstock 可支援所有台灣上市股票（1500+）。

### Q5: 如何添加新的行業別？

**A**: 編輯 `taiwan_stock_crawler.py`，在 `TAIWAN_STOCKS_BY_INDUSTRY` 字典中添加新行業：

```python
TAIWAN_STOCKS_BY_INDUSTRY = {
    # ... 現有行業 ...
    '新行業名稱': [
        ('代碼1', '股票名稱1'),
        ('代碼2', '股票名稱2'),
        # ...
    ]
}
```

---

## 📝 檔案結構

```
lession8_1/
├── stock_monitor_gui.py           # 主 GUI 應用 ⭐
├── taiwan_stock_crawler.py        # 爬蟲模組（包含行業分類）⭐
├── watchlist.json                 # 觀察清單設定（自動生成）
└── README.md                       # 本文檔
```

### taiwan_stock_crawler.py 關鍵部分

```python
# 14+ 行業分類，每行業市值前 30 大
TAIWAN_STOCKS_BY_INDUSTRY = {
    '半導體': [...],      # 台積電、聯發科等
    '電子': [...],        # 鴻海、廣達等
    '金融': [...],        # 中信金等
    # ... 11+ 更多行業 ...
}

class TaiwanStockCrawler:
    @staticmethod
    def get_industries() -> Dict:
        """取得按行業別分類的股票清單"""
        return TAIWAN_STOCKS_BY_INDUSTRY
    
    def search_stocks(self, keyword, industry=None):
        """搜尋股票（支援行業篩選）"""
        # 支援在特定行業或全部行業搜尋
```

---

## 💡 最佳實踐

✅ **定期更新** - 勾選自動更新以監控價格變動  
✅ **適度篩選** - 只監控感興趣的股票以提高效率  
✅ **定期備份** - 定期備份 `watchlist.json`  
✅ **結合分析** - 搭配技術面/基本面分析做投資決策  

---

## ⚠️ 免責聲明

本應用僅供教育和學習之用。  
**投資前請自行研究，並諮詢專業理財顧問。**  
使用本應用進行的任何交易決策由使用者自行承擔風險。

---

## 🔗 相關資源

- 台灣證交所官網: https://www.twse.com.tw/
- twstock 文檔: https://github.com/mlouielu/twstock
- Python Tkinter 教學: https://docs.python.org/3/library/tkinter.html

---

## 📞 支援

如有問題或建議，請聯絡開發者或提交 Issue。

**最後更新**: 2025-12-20  
**版本**: 1.0  
**作者**: AI Programming Assistant

---

祝投資順利！📈

